{
    "dag_id": "{{ params.workflow_name }}_{{ params.er_cron_date_unified }}", 
    "start": "CheckAndMarkRfiRecentDataReadyFile", 
    "end": "end_1", 
    "operators": [
        {
            "task_id": "CheckAndMarkRfiRecentDataReadyFile", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.check_and_mark_max_done_file_script }} {{ params.etl_daily_aggregate_jobs_done_marker_path }} {{ params.rfi_recent_data_ready_marker_path }}", 
            "post_task": [
                "CheckAndMarkRfiRecentConvDataReadyFile"
            ]
        }, 
        {
            "task_id": "CheckAndMarkRfiRecentConvDataReadyFile", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.check_and_mark_max_done_file_script }} {{ params.epiphany_daily_attribution_jobs_done_marker_path }} {{ params.rfi_recent_conv_data_ready_marker_path }}", 
            "post_task": [
                "fork_load_data"
            ]
        }, 
        {
            "task_id": "LoadAdvertiserDataToHive", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.load_adv_data_to_hive_script }} {{ params.environment }} {{ params.vertica_reports_db_ro_url }} {{ params.vertica_reports_db_ro_username }} {{ params.vertica_reports_db_ro_pwd }} {{ params.vertica_reports_db_ro_schema }} {{ params.er_cron_date_unified }} {{ params.advertiser_param_data_inclusion_days }} {{ params.rfi_recent_data_ready_marker_path }}", 
            "post_task": [
                "join_load_data"
            ]
        }, 
        {
            "task_id": "LoadAdvertiserFilterReducerConfig", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} {{ params.CODE_BASE }}/dp/externalreport/whitelist_info_bin --type advertiser --output {{ params.VAR_BASE }}/config_advertiser_filter.yml", 
            "post_task": [
                "join_load_data"
            ]
        }, 
        {
            "task_id": "LoadAdvertiserAdMapping", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.CODE_BASE }}/scripts/hive/load-advertiser-ad-mapping {{ params.environment }} {{ params.reports_db_ro_url }} {{ params.reports_db_ro_username }} {{ params.reports_db_ro_pwd }} {{ params.reports_db_ro_schema }} {{ params.er_cron_date_unified }}", 
            "post_task": [
                "join_load_data"
            ]
        }, 
        {
            "task_id": "LoadPublisherDataToHive", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.load_pub_data_to_hive_script }} {{ params.environment }} {{ params.reports_db_ro_url }} {{ params.reports_db_ro_username }} {{ params.reports_db_ro_pwd }} {{ params.reports_db_ro_schema }} {{ params.er_cron_date_unified }} {{ params.publisher_param_data_inclusion_days }} {{ params.rfi_recent_data_ready_marker_path }}", 
            "post_task": [
                "join_load_data"
            ]
        }, 
        {
            "task_id": "LoadPublisherFilterReducerConfig", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} {{ params.CODE_BASE }}/dp/externalreport/whitelist_info_bin --type publisher --output {{ params.VAR_BASE }}/config_publisher_filter.yml", 
            "post_task": [
                "join_load_data"
            ]
        }, 
        {
            "task_id": "LoadAdvertiserConversionDataToHive", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.load_adv_conv_data_to_hive_script }} {{ params.environment }} {{ params.vertica_reports_db_ro_url }} {{ params.vertica_reports_db_ro_username }} {{ params.vertica_reports_db_ro_pwd }} {{ params.vertica_reports_db_ro_schema }} {{ params.er_cron_date_unified }} {{ params.advertiser_conversion_data_inclusion_days }} {{ params.rfi_recent_conv_data_ready_marker_path }}", 
            "post_task": [
                "join_load_data"
            ]
        }, 
        {
            "task_id": "LoadAdvertiserXdConversionDataToHive", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.load_adv_xd_conv_data_to_hive_script }} {{ params.environment }} {{ params.vertica_reports_db_ro_url }} {{ params.vertica_reports_db_ro_username }} {{ params.vertica_reports_db_ro_pwd }} {{ params.vertica_reports_db_ro_schema }} {{ params.er_cron_date_unified }} {{ params.advertiser_conversion_data_inclusion_days }} {{ params.rfi_recent_conv_data_ready_marker_path }}", 
            "post_task": [
                "join_load_data"
            ]
        }, 
        {
            "task_id": "LoadConversionFilterReducerConfig", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} {{ params.CODE_BASE }}/dp/externalreport/whitelist_info_bin --type conversion --output {{ params.VAR_BASE }}/config_conversion_filter.yml", 
            "post_task": [
                "join_load_data"
            ]
        }, 
        {
            "task_id": "LoadRfiAggregateImpressions", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.CODE_BASE }}/scripts/hive/load_rfi_aggregate_impressions {{ params.environment }} {{ params.er_cron_date_unified }} {{ params.rfi_agg_data_lookback_days }}", 
            "post_task": [
                "join_load_data"
            ]
        }, 
        {
            "task_id": "LoadRfiAggregateDailyConversionAction", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.CODE_BASE }}/scripts/hive/load_rfi_aggregate_daily_conversion_action {{ params.environment }} {{ params.er_cron_date_unified }} {{ params.rfi_agg_data_lookback_days }} {{ params.rfi_recent_conv_data_ready_marker_path }} {{ params.er_rfi_agg_daily_conversion_action_marker_path }}", 
            "post_task": [
                "fork_load_conv_data", 
                "join_load_data"
            ]
        }, 
        {
            "task_id": "LoadRfiAggregateConversionAction", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.CODE_BASE }}/scripts/hive/load_rfi_aggregate_conversion_action {{ params.environment }} {{ params.er_cron_date_unified }} {{ params.rfi_agg_data_lookback_days }}", 
            "post_task": [
                "join_load_conv_data"
            ]
        }, 
        {
            "task_id": "LoadRfiXdAggregateConversionAction", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.CODE_BASE }}/scripts/hive/load_rfi_xd_aggregate_conversion_action {{ params.environment }} {{ params.er_cron_date_unified }} {{ params.rfi_agg_data_lookback_days }}", 
            "post_task": [
                "join_load_conv_data"
            ]
        }, 
        {
            "task_id": "AdvertiserReport", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.CODE_BASE }}/scripts/spark/advertiser_report {{ params.environment }} {{ params.er_cron_date_unified }} {{ params.rfi_agg_data_lookback_days }}", 
            "post_task": [
                "join_1", 
                "LoadAdvertiserRatioToVertica"
            ]
        }, 
        {
            "task_id": "LoadAdvertiserRatioToVertica", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} {{ params.CODE_BASE }}/dp/externalreport/hive_to_vertica_loader_bin --environment {{ params.environment }} --run_date {{ params.er_cron_date_unified }} --look_back_days {{ params.advertiser_param_data_inclusion_days }} --table advertiser_external_ratio", 
            "post_task": [
                "join_1"
            ]
        }, 
        {
            "task_id": "PublisherReport", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.CODE_BASE }}/scripts/spark/publisher_report {{ params.environment }} {{ params.er_cron_date_unified }} {{ params.rfi_agg_data_lookback_days }}", 
            "post_task": [
                "join_1", 
                "LoadPublisherRatioToVertica"
            ]
        }, 
        {
            "task_id": "LoadPublisherRatioToVertica", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} {{ params.CODE_BASE }}/dp/externalreport/hive_to_vertica_loader_bin --environment {{ params.environment }} --run_date {{ params.er_cron_date_unified }} --look_back_days {{ params.publisher_param_data_inclusion_days }} --table publisher_external_ratio", 
            "post_task": [
                "LoadAggregateAdLogsAndPublisherDataToVertica", 
                "join_1"
            ]
        }, 
        {
            "task_id": "LoadAggregateAdLogsAndPublisherDataToVertica", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} {{ params.CODE_BASE }}/dp/externalreport/hive_to_vertica_loader_bin --environment {{ params.environment }} --run_date {{ params.er_cron_date_unified }} --look_back_days {{ params.publisher_param_data_inclusion_days }} --table ad_logs_and_publisher_data", 
            "post_task": [
                "join_1"
            ]
        }, 
        {
            "task_id": "ConversionReport", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.CODE_BASE }}/scripts/spark/conversion_report {{ params.environment }} {{ params.er_cron_date_unified }}", 
            "post_task": [
                "LoadConversionRatioToVertica", 
                "join_1"
            ]
        }, 
        {
            "task_id": "LoadConversionRatioToVertica", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} {{ params.CODE_BASE }}/dp/externalreport/hive_to_vertica_loader_bin --environment {{ params.environment }} --run_date {{ params.er_cron_date_unified }} --look_back_days {{ params.advertiser_conversion_data_inclusion_days }} --table advertiser_external_conversion_ratio", 
            "post_task": [
                "join_1"
            ]
        }, 
        {
            "task_id": "XdConversionReport", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.CODE_BASE }}/scripts/spark/xd_conversion_report {{ params.environment }} {{ params.er_cron_date_unified }}", 
            "post_task": [
                "join_1"
            ]
        }, 
        {
            "task_id": "CheckAndMarkImpressionReadyDoneFile", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.check_and_mark_max_done_file_script }} {{ params.rfi_recent_data_ready_marker_path }} {{ params.impression_ready_done_marker_path }}", 
            "post_task": [
                "CheckAndMarkConversionReadyDoneFile"
            ]
        }, 
        {
            "task_id": "CheckAndMarkConversionReadyDoneFile", 
            "operator_type": "bash", 
            "bash_command": "ssh -l {{params.owner}} {{ params.er_cron_host }} /bin/bash {{ params.check_and_mark_max_done_file_script }} {{ params.rfi_recent_conv_data_ready_marker_path }} {{ params.conversion_ready_done_marker_path }}", 
            "post_task": []
        }, 
        {
            "task_id": "CheckLoadDataError", 
            "operator_type": "dummy", 
            "post_task": [
                "fork_1"
            ]
        }, 
        {
            "task_id": "CheckErrors", 
            "operator_type": "dummy", 
            "post_task": [
                "CheckAndMarkImpressionReadyDoneFile"
            ]
        }, 
        {
            "task_id": "fork_load_data", 
            "operator_type": "dummy", 
            "post_task": [
                "LoadAdvertiserDataToHive", 
                "LoadAdvertiserFilterReducerConfig", 
                "LoadAdvertiserAdMapping", 
                "LoadPublisherDataToHive", 
                "LoadPublisherFilterReducerConfig", 
                "LoadAdvertiserConversionDataToHive", 
                "LoadAdvertiserXdConversionDataToHive", 
                "LoadConversionFilterReducerConfig", 
                "LoadRfiAggregateImpressions", 
                "LoadRfiAggregateDailyConversionAction"
            ]
        }, 
        {
            "task_id": "fork_load_conv_data", 
            "operator_type": "dummy", 
            "post_task": [
                "LoadRfiAggregateConversionAction", 
                "LoadRfiXdAggregateConversionAction"
            ]
        }, 
        {
            "task_id": "fork_1", 
            "operator_type": "dummy", 
            "post_task": [
                "AdvertiserReport", 
                "PublisherReport", 
                "ConversionReport", 
                "XdConversionReport"
            ]
        }, 
        {
            "task_id": "join_load_data", 
            "operator_type": "dummy", 
            "post_task": [
                "CheckLoadDataError"
            ]
        }, 
        {
            "task_id": "join_load_conv_data", 
            "operator_type": "dummy", 
            "post_task": [
                "join_load_data"
            ]
        }, 
        {
            "task_id": "join_1", 
            "operator_type": "dummy", 
            "post_task": [
                "CheckErrors"
            ]
        }
    ]
}